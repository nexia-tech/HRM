{% extends 'base.html' %}

{% block body %}

    <section class="text-gray-400 bg-gray-900 body-font relative">
        <div class="container px-5 py-24 mx-auto flex sm:flex-nowrap flex-wrap">
          <div class="lg:w-1/3 md:w-1/2 bg-gray-900 rounded-lg overflow-hidden sm:mr-10 p-10 flex items-end justify-start relative">
            <div class="h-full text-center">
                {% if attendance_obj.employee.profile_picture %}
                <img alt="profile-pic" class="w-30 h-30 mb-8 object-cover object-center rounded-full inline-block border-2 border-gray-800 bg-gray-800 bg-opacity-10" src="{{attendance_obj.employee.profile_picture.url}}">
                {% else %}
                <img alt="profile-pic" class="w-30 h-30 mb-8 object-cover object-center rounded-full inline-block border-2 border-gray-800 bg-gray-800 bg-opacity-10" src="https://api.dicebear.com/9.x/bottts-neutral/svg?eyes=robocop">
                
                {% endif %}
                <p class="leading-relaxed">{{attendance_obj.employee.bio}}</p>
                <span class="inline-block h-1 w-10 rounded bg-blue-500 mt-6 mb-4"></span>
                <p class="text-gray-500">{{attendance_obj.employee.department.name}}</p>
                <h2 class="text-white font-medium title-font tracking-wider text-sm">{{attendance_obj.employee.name}}</h2>
                <p class="text-gray-500">{{attendance_obj.employee.designation}}</p>
              </div>
          </div>
          <div class="flex flex-col w-full">
          <div class="lg:w-2/3 md:w-1/2 flex flex-col md:ml-auto w-full md:py-8 mt-8 md:mt-0">
              <h1 class="text-4xl font-bold mb-4">Shift Timing</h1>
              <div id="timer" class="text-6xl font-bold mb-4">{{attendance_obj.remaining_hours}}</div>
              <div class="space-x-4">
                  <button id="startTimerBtn" class="bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded">
                      Start Timer
                  </button>
                  <button id="stopTimerBtn" class="bg-red-500 hover:bg-red-700 text-white py-2 px-4 rounded">
                      Stop Timer
                  </button>
              </div>
          
          
          </div>

          <div class="lg:w-2/3 md:w-1/2 flex flex-col md:ml-auto w-full md:py-8 mt-8 md:mt-0">
            <h1 class="text-4xl font-bold mb-4">Over Timing</h1>
            <div id="timer" class="text-6xl font-bold mb-4">{{attendance_obj.remaining_hours}}</div>
            <div class="space-x-4">
                <button id="overStartTimerBtn" class="bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded">
                    Start Timer
                </button>
                <button id="overStopTimerBtn" class="bg-red-500 hover:bg-red-700 text-white py-2 px-4 rounded">
                    Stop Timer
                </button>
            </div>
          </div>
        </div>
        
         
        
    
        </div>
        
      </section>

{% endblock body %}


{% block script %}


<script>
  let shiftDurationHours = "{{ attendance_obj.remaining_hours }}";
  
  let timerInterval = null;
  shiftDurationHours = parseInt(shiftDurationHours.split(':')[0])
  
  let remainingTime = parseInt(shiftDurationHours) * 60 * 60 * 1000; // Convert hours to milliseconds



  function updateTimer() {
      if (remainingTime <= 0) {
          clearInterval(timerInterval);
          document.getElementById('timer').textContent = '00:00:00';
          return;
      }
      
      const hours = Math.floor(remainingTime / (1000 * 60 * 60));
      const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);
      
      const formattedTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      
      document.getElementById('timer').textContent = formattedTime;
      remainingTime -= 1000; // Decrease remaining time by 1 second (1000 milliseconds)
  }
  
  document.getElementById('startTimerBtn').addEventListener('click', function() {
      if (!timerInterval) {
          timerInterval = setInterval(updateTimer, 1000);
      }
  });

  document.getElementById('stopTimerBtn').addEventListener('click', function() {
    clearInterval(timerInterval);
    timerInterval = null;
});
</script>

{% endblock script %}